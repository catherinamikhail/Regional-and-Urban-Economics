---
title: "Assignment Week 5 Regional and Urban Economics"
subtitle: Catherina Mikhail, 2847118; Sinem Göral, 2817932; Ela Köycü, 2846357.Tutorial group 4
output: word_document
date: "2025-11-24"
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyverse")
#install.packages("stargazer")
#install.packages("sjPlot")
library(stargazer)
library(tidyverse)
library(sjPlot) 
data <- read_csv(file = "monocentric_2016.csv")

```

1 The assignment 

1.1 Introduction and hypotheses 

The municipality of Utrecht is one of the most densely populated areas in the Netherlands and serves as a key economic and administrative center. Its central location, transport connections, and mix of urban and suburban neighborhoods make it an ideal case to study how land prices vary with distance from the municipal CBD.

The aim is to compare land prices in the municipality of Utrecht with the national pattern to understand whether the municipality follows general trends or displays local deviations due to urban density, historical structures, or amenities.

The basic regression equation that shows the relationship between the land prices and the distance to the Central Business District is given by: linear case  => P_i = beta_0 + beta_1 * DistanceCBD_i + epsilon_i and log-linear case => Ln(P_i) = beta_0 + beta_1 * DistanceCBD_i + epsilon_i if land prices are skewed. 

P_i = The price of the land per m^2 for location i 
beta_0 = estimated land price at the CBD
beta_1 = slope of the linear regression model, so it is the expected change in price per km away from the CBD
DistanceCBD_i = distance from a particular location in km to the CBD

Our hypotheses based on the theory is that the relationship between land prices and the distance to the Central Business District is negative. So, the further away from the CBD, the lower the land prices => H0: beta_1 = 0, H1: beta_1 < 0. This is because land is more valuable closer to the CBD due to agglomeration effects (increasing returns to scale) and particular amenities, making people willing to pay more to locate closer to the CBD.

Our other hypothesis particular for the municipality of Utrecht is that the slope may be steeper than the national average because Utrecht municipality is compact, with high-density neighborhoods around the CBD => H0: beta_1 of Utrecht  = beta_1 of The Netherlands, H1: beta_1 of Utrecht > beta_1 of The Netherlands.

Because we think that land prices are skewed, we will use a log-linear regression model. This means that if we interpret the outcome of the model, the answer will be in percentages.


1.2 Data and descriptives

1.2.1 Determination of land prices 

The land-rent data come from a hedonic-pricing approach. Rather than simply observing land sales, they estimate the implicit land value by exploiting variation in lot sizes across many housing transactions. Because lot sizes differ significantly (smaller in densely built-up urban areas and larger in more peripheral regions),their regression allows them to identify how much of the housing price is attributable to the land itself.

Finally, they adjust for temporal price differences using time dummies in the regression, so all land rents are expressed in real terms. By mapping these derived land rents and comparing them with variables such as distance to city centers and population density, the method produces a detailed spatial surface of land rents—making it possible to analyze how land values decline (or vary) across urban areas like in our case for the municipality of Utrecht.

1.2.2 Descriptives 

We can see here that the descriptive statistics reveal notable differences between Utrecht and the Netherlands. Utrecht has a higher average land price (lnpricem2) of 5.87, with a standard deviation of 0.77, which indicates Utrecht has that relatively high land prices with moderate variation. In contrast, the Netherlands has an average land price of 4.47, with a standard deviation of 1.15, indicating lower land prices with more variation.

The average distance to CBD (distcbd) in Utrecht is 3.11 km, with a standard deviation of 1.94, suggesting a compact urban area. Which is also known in the Netherlands, that Utrecht is one of the relatively smaller cities in de Randstad. In the Netherlands, the average distance to CBD is 10.30 km, with a standard deviation of 7.79, indicating a more spread-out urban landscape.

Population density (popdens) in Utrecht averages 57.01 people per km², with a standard deviation of 40.11, indicating a moderately dense area with significant variation. In the Netherlands, population density averages 16.62 people per km², with a standard deviation of 28.26, indicating much lower density with significant variation.

The share of foreign-born residents (shforeign) in Utrecht is 0.27, with a standard deviation of 0.13, suggesting a more diverse population. In the Netherlands, the share of foreign-born residents is 0.13, with a standard deviation of 0.12, indicating less overall diversity.

The variables used in the regression analysis include the natural logarithm of land prices per square meter, distance to the CBD, population density, share of foreign-born residents, share of residential land, age structure variables, share of land infrastructure, and share of open space. These variables capture the relationship between land prices and distance to the CBD, while controlling for urban amenities, neighborhood characteristics, and demographic factors.

By including these variables, we want to estimate with the the regression analysis the distance gradient, see what the effects are of urban amenities and neighborhood characteristics on land prices, and reduce omitted variable bias, ultimately providing insights into the determinants of land prices in Utrecht and the Netherlands.

```{r}
library(stargazer)
library(dplyr)

# Calculate descriptive statistics for Utrecht
utrecht_stats <- df_utrecht_clean %>% 
  summarise(across(everything(), list(
    Mean = ~mean(.x, na.rm = TRUE),
    SD = ~sd(.x, na.rm = TRUE),
    Min = ~min(.x, na.rm = TRUE),
    Max = ~max(.x, na.rm = TRUE),
    N = ~sum(!is.na(.x))
  )))

# Calculate descriptive statistics for the Netherlands
nl_stats <- data %>%
  summarise(across(everything(), list(
    Mean = ~mean(.x, na.rm = TRUE),
    SD = ~sd(.x, na.rm = TRUE),
    Min = ~min(.x, na.rm = TRUE),
    Max = ~max(.x, na.rm = TRUE),
    N = ~sum(!is.na(.x))
  )))

library(stargazer)

library(stargazer)

stargazer(df_utrecht_clean, data, 
          type = "text",
          title = "Descriptive Statistics for Utrecht and the Netherlands",
          digits = 2,
          summary.stat = c("mean", "sd", "min", "max", "N"),
          column.labels = c("Utrecht", "The Netherlands"))
```

```{r}
# Making a subset of the data of the municipality of Utrecht
df_utrecht = data %>%
  filter(grepl("Utrecht", munname))
df_utrecht_clean <- na.omit(df_utrecht[, c("lnpricem2", "distcbd", "shlandinfr","shopenspace", "popdens", "shforeign", "shlandres", "shyoungp", "shelderly")])


# Creating a table with the descriptive statistics of the municipality of Utrecht
library(dplyr)
library(knitr)

# Calculate descriptive statistics of the municipality of Utrecht
stats <- df_utrecht_clean %>%
  select(lnpricem2, distcbd, shlandinfr,shopenspace, popdens, shforeign, shlandres, shyoungp, shelderly)%>%
  summarise(across(everything(), list(
    Mean = ~mean(.x, na.rm = TRUE),
    SD = ~sd(.x, na.rm = TRUE),
    Min = ~min(.x, na.rm = TRUE),
    Max = ~max(.x, na.rm = TRUE),
    N = ~sum(!is.na(.x))
  )) %>%
  pivot_longer(everything(), names_to = c("Variable", ".value"), names_sep = "_"))

# Format the table of teh descriptive statistics of the municipality of Utrecht
kable(stats, format = "markdown", caption = "Descriptive Statistics for Utrecht", digits = 2)

# Now I will do the same for The Netherlands

# Calculate descriptive statistics for national level
national_stats <- data %>%
  select(lnpricem2, distcbd, shlandinfr,shopenspace, popdens, shforeign, shlandres, shyoungp, shelderly) %>%
  summarise(across(everything(), list(
    Mean = ~mean(.x, na.rm = TRUE),
    SD = ~sd(.x, na.rm = TRUE),
    Min = ~min(.x, na.rm = TRUE),
    Max = ~max(.x, na.rm = TRUE),
    N = ~sum(!is.na(.x))
  )) %>%
  pivot_longer(everything(), names_to = c("Variable", ".value"), names_sep = "_"))

# Format the table for the national level
kable(national_stats, format = "markdown", caption = "Descriptive Statistics for The Netherlands", digits = 2)
         
```


1.2.3 Outliers and missings Explain what you do with outliers and
missing values.

When preparing the dataset, we checked for missing values and outliers to make sure the regression results are not biased. Missing values were handled by removing incomplete observations, which is fine because there are very few missing cases and they don’t seem related to the dependent variable. For outliers we looked at key variables, especially land prices and distance to the CBD, for extreme values. Since land prices are log-transformed, extreme values have less impact, and the distance and socioeconomic variables don’t have any unrealistic values, so no trimming was needed. By removing missing values and relying on the log transformation, the dataset is clean and reliable for the regression analysis.

1.3 Model and results

1.3.1 Estimation Estimate the model and interpret the results.

To estimate the relationship between land prices and distance to the CBD, we use a log-linear regression model where the logarithm of land price per m² is regressed on distance from the Utrecht CBD. The basic regression shows a clear and statistically significant negative coefficient on distance (β₁ = -0.25777, p < 0.001), meaning that land prices decrease as one moves farther away from the central business district. Because the dependent variable is in logs, this coefficient can be interpreted as approximately a 25.78% decline in land value associated with each additional kilometer of distance. The sign and significance of the coefficient confirm the theoretical expectation from the monocentric city model: accessibility and agglomeration effects are strongest near the center, making land close to the CBD more valuable. Thus, we reject the null hypothesis H₀: β₁ = 0 and accept that distance has a meaningful negative effect on land prices in Utrecht.

The national-level regression yields a coefficient of -0.071858 (p < 0.001), indicating that for each kilometer increase in distance from the CBD, land prices decrease by approximately 7.19%. Comparing this to Utrecht's coefficient of -0.25777, the effect of distance on land prices appears stronger in Utrecht. This suggests that land prices in Utrecht are more sensitive to distance from the CBD, possibly due to Utrecht's smaller size and more centralized economic activity, whereas the national average reflects a broader, more varied urban landscape with multiple economic centers.

```{r}
# Basic regression model of log-linear model

model_basic_utrecht <- lm(lnpricem2 ~ distcbd, data = df_utrecht_clean)
summary(model_basic_utrecht)

model_basic_national = lm(lnpricem2 ~ distcbd, data=data)
summary(model_basic_national)


```


1.3.2 Amenities 

Land values depend not only on distance to the CBD but also on local amenities and neighborhood traits, so the basic model risks omitted-variable bias. To address this, we add controls such as population density, the share of foreign-born residents, the share of residential land, the share of open space, and the share of land infrastructure. These variables capture key spatial features that shape willingness to pay for land. Population density, in particular, proxies for many unobserved amenities, since dense areas usually offer better services, more shops and cultural venues, greater accessibility, and stronger labor market links. The share of open space captures access to green spaces and recreational areas, while the share of land infrastructure reflects infrastructure development and accessibility. After adding these amenity controls, the distance coefficient shrinks but remains negative and significant, indicating that the basic model partly captured amenity differences that decline with distance. Including these controls thus improves the accuracy of the estimated distance gradient.

1.3.3 Present your results 

In the tables under, you will find the regression outcomes of the basic and extended regression models. Here, we examined the relationship between land prices (lnpricem2) and distance to the city center (distcbd) for Utrecht and national levels, with and without controls.

Interpretation of the coefficients and hypothesis testing in the regression models:
Basic Models
- Utrecht Basic Model
    - Intercept: 6.672***, this is the expected land price at the CBD in log euros/m²
    - distcbd: -0.258***, this means that a 1 km increase in distance is associated with a 25.8% decrease in land price and that it is  statistically significant at 1% level, given by the three stars.
    - R²: 0.422, this means that 42.2% of variation in the model is explained.
    - Hypothesis test: H0: β1 = 0 rejected, because the p-value is 5.69e-06 and is therefore much smaller than a significance level of 1%. This implies that distance to CBD has a significant negative effect on land prices.
    
- National Basic Model
    - Intercept: 5.213***, this is the expected land price at CBD in log euros/m²
    - distcbd: -0.072***, this implies that a 1 km increase in distance is associated with a 7.2% decrease in land price and that it is statistically significant at 1% level, given by the three stars.
    - R²: 0.238, this means that 23.8% of variation explained in the model.
    - Hypothesis test: H0: β1 = 0 rejected because the p-value is smaller than 2e-16, so it is smaller than the 1% significance level. Therefore, distance to CBD has a significant negative effect on land prices.

Extended Models
- Utrecht Extended Model
    - Intercept: 6.681***, this is the expected land price at CBD in log euros/m²
    - distcbd: -0.178**, this implies that 1 km increase in distance is associated with a 17.8% decrease in land price, holding all other variables constant and that it is  statistically significant at 5% level, given the two stars.
    - popdens: 0.001, holding all other variables constant, a insignificant effect of population density on land prices)
    - shforeign: -0.082 (insignificant effect of foreign-born share on land prices)
    - shlandres: 0.873 (insignificant effect of residential land share on land prices)
    - shyoungp: -0.280 (insignificant effect of young population share on land prices)
    - shelderly: -5.846** (1% increase in elderly share → 5.846% decrease in land price, statistically significant at 5% level)
    - R²: 0.657 (65.7% of variation explained)
- National Extended Model
    - Intercept: 4.329*** (expected land price at CBD, in log euros/m²)
    - distcbd: -0.030*** (1 km increase in distance → 3.0% decrease in land price, controlling for other factors, statistically significant at 1% level)
    - popdens: -0.0004 (insignificant effect of population density on land prices)
    - shforeign: 1.584*** (1% increase in foreign-born share → 1.584% increase in land price, statistically significant at 1% level)
    - shlandres: 2.235*** (1% increase in residential land share → 2.235% increase in land price, statistically significant at 1% level)
    - shyoungp: -0.724* (1% increase in young population share → 0.724% decrease in land price, statistically significant at 10% level)
    - shelderly: 0.020 (insignificant effect of elderly share on land prices)
    - R²: 0.503 (50.3% of variation explained)

Model Comparison
- Distance to CBD has a stronger negative effect in Utrecht vs. national level in both basic and extended models.
- Controls improve model fit more for Utrecht (R²: 0.422 → 0.657) than national level (R²: 0.238 → 0.503).
- Utrecht models explain more variation in land prices, suggesting local factors play a bigger role.

The analysis suggests that distance to CBD is a key factor in land prices, especially in Utrecht, with demographic and land use factors also contributing.
```{r, results = "asis"}
# Load the stargazer package
library(stargazer)

# Estimate the basic and extended models for Utrecht
model_basic_utrecht <- lm(lnpricem2 ~ distcbd, data = df_utrecht_clean)
model_extended_utrecht <- lm(lnpricem2 ~ distcbd + popdens + shforeign + shlandinfr + shopenspace + shlandres + shyoungp + shelderly, data = df_utrecht_clean)

# Estimate the basic and extended models for national
model_basic_national <- lm(lnpricem2 ~ distcbd, data = data)
model_extended_national <- lm(lnpricem2 ~ distcbd + popdens + shforeign+shlandinfr + shopenspace + shlandres + shyoungp + shelderly, data = data)

# Create a table with the regression outcomes
library(stargazer)
stargazer(
  model_basic_utrecht,
  model_extended_utrecht,
  type = "html",
  title = "Regression Results – Utrecht",
  dep.var.labels = "ln(price per m2)",
  column.labels = c("Basic", "Extended"),
  column.separate = c(1,1),
  covariate.labels = c("Distance to CBD",
                       "Population Density",
                       "Share Foreign",
                       "Share Land Residential",
                       "Share Young Population",
                       "Share Elderly Population"),
  digits = 3,
  no.space = TRUE
)

stargazer(
  model_basic_national,
  model_extended_national,
  type = "html",
  title = "Regression Results – National",
  dep.var.labels = "ln(price per m2)",
  column.labels = c("Basic", "Extended"),
  column.separate = c(1,1),
  covariate.labels = c("Distance to CBD",
                       "Population Density",
                       "Share Foreign",
                       "Share Land Residential",
                       "Share Young Population",
                       "Share Elderly Population"),
  digits = 3,
  no.space = TRUE
)

```



1.4 Conclusions Describe the conclusions for your municipality and
discuss possible problems related to the OLS assumptions. Give
suggestions for solutions to solve these problems in future research.
