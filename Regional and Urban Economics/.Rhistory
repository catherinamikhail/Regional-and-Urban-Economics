labs(
title = "Average PR per Genre",
y = "Mean PR",
x = "Genre"
)
#WRITE YOUR CODE HERE
mean_PR <- aggregate(PR ~ genre2, data = movies3, FUN = mean, na.rm = TRUE)
n <- aggregate(PR ~ genre2, data = movies3, FUN = function(x) sum(!is.na(x)))$PR
sd_PR <- aggregate(PR ~ genre2, data = movies3, FUN = sd, na.rm = TRUE)$PR
se <- sd_PR / sqrt(n)
mean_PR$ci_lower <- mean_PR$PR - qt(0.975, df = n-1) * se
mean_PR$ci_upper <- mean_PR$PR + qt(0.975, df = n-1) * se
###Creating a scatterplot###
library("ggplot2")
ggplot(mean_PR, aes(x = genre2, y = PR)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2)
labs(
title = "Average PR per Genre",
y = "Genre",
x = "Mean PR"
)
#WRITE YOUR CODE HERE
###Creating a new datframe which is a random subsample###
sample_genre <- slice_sample(movies3, n = 100)
###Calculating the mean, standard deviation, and number of observations of PR in the sample for each genre###
agg_sample <- aggregate(PR ~ genre2, data = sample_genre, FUN = function(x) c(mean = mean(x), sd = sd(x), n = length(x)))
agg_sample2 <- data.frame(
genre2 = agg_sample$genre2,
PR_mean = agg_sample$PR[, "mean"],
SD = agg_sample$PR[, "sd"],
n = agg_sample$PR[, "n"]
)
###Calculating the confidence intervals (CI's)###
agg_sample2$ci_lower <- agg_sample2$PR_mean - 1.96 * agg_sample2$SD / sqrt(agg_sample2$n)
agg_sample2$ci_upper <- agg_sample2$PR_mean + 1.96 * agg_sample2$SD / sqrt(agg_sample2$n)
###Creating a scatterplot###
library("ggplot2")
ggplot(agg_sample2, aes(x = genre2, y = PR_mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
labs(
title = "Average PR per Genre",
y = "Mean PR",
x = "Genre"
)
#WRITE YOUR CODE HERE
movies3$PR <- ifelse(movies3$budget > 0, movies3$revenue / movies3$budget, NA)
movies3_clean <- movies3[is.finite(movies3$PR) & is.finite(movies3$budget), ]
lm1 <- lm(PR ~ budget, data = movies3_clean)
summary(lm1)
coef(summary(lm1))
summary(lm1)
fitted_values <- fitted(lm1)
residual_values <- residuals(lm1)
head(fitted_values)
head(residual_values)
hist(residuals(lm1),
breaks = 30,
main = "Histogram of Residuals",
xlab = "Residuals",
col = "skyblue",
border = "white")
hat_values <- hatvalues(lm1)
critical_value <- 2 * mean(hat_values)
high_leverage_points <- which(hat_values > critical_value)
high_leverage_points
plot(hat_values, main = "Leverage (Hat) Values",
ylab = "Hat Value", xlab = "Observations")
abline(h = critical_value, col = "red", lty = 2)
movies3_no_outliers <- movies3_clean[-high_leverage_points, ]
lm2 <- lm(PR ~ budget, data = movies3_no_outliers)
summary(lm2)
#WRITE YOUR CODE HERE
library("ggplot2")
ggplot(movies3, aes(x = runtime, y = vote_average)) +
geom_point() +
geom_smooth(method = "lm") +
labs(
title = "Scatterplot",
y = "Vote average",
x = "Runtime"
)
#WRITE YOUR CODE HERE
lm1 <- lm(vote_average ~ runtime, data = movies3)
summary(lm1)
movies3$predict <- predict(lm1)
movies3$residual <- residuals(lm1)
overperformer <- movies3[which.max(movies3$residual),]
print(overperformer[c("title", "vote_average", "predict", "residual")])
#WRITE YOUR CODE HERE
library(dplyr)
movies_with_mean <- movies3 %>%
group_by(release_year) %>%
mutate(mean_PR = mean(PR, na.rm = TRUE))
ci_df <- movies_with_ci %>%
distinct(release_year, mean_PR, ci_lower, ci_upper) %>%
rename(mean = mean_PR, lower = ci_lower, upper = ci_upper)
ggplot(ci_df, aes(x = release_year, y = mean)) +
geom_line(color = "blue") +
geom_point(size = 2, color = "darkblue") +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2, color = "blue") +
labs(
title = "Mean PR by Year with 95% Confidence Intervals",
x = "Year of Release",
y = "Mean PR"
) +
theme_minimal()
#WRITE YOUR CODE HERE
#WRITE YOUR CODE HERE
#WRITE YOUR CODE HERE
#WRITE YOUR CODE HERE
knitr::opts_chunk$set(echo = TRUE)
library(readr)
movies3 <- read_tsv("movies3.tsv", show_col_types = FALSE)
ncol(movies3)
nrow(movies3)
length(unique(movies3$title))
str(movies3)
library("dplyr")
movies3 = mutate(movies3, PR = revenue/budget)
mean(movies3$PR, na.rm = TRUE)
median(movies3$PR, na.rm = TRUE)
min(movies3$PR, na.rm = TRUE)
max(movies3$PR, na.rm = TRUE)
#WRITE YOUR CODE HERE
#WRITE YOUR CODE HERE
movies3$PR[is.infinite(movies3$PR)] <- NA
mean(movies3$PR, na.rm = TRUE)
median(movies3$PR, na.rm = TRUE)
max(movies3$PR, na.rm = TRUE)
min(movies3$PR, na.rm = TRUE)
sum(movies3$PR >= 1, na.rm = TRUE) / sum(!is.na(movies3$PR))
library("ggplot2")
ggplot(movies3, aes(y = PR)) +
geom_boxplot() +
ylim(0,5) +
xlim(-0.8, 0.8) +
labs(
title = "Profitability Ratio of Movies",
y = "PR",
x = "Movies"
)
quantile(movies3$PR, probs = c(0.25), na.rm = TRUE)
quantile(movies3$PR, probs = c(0.50), na.rm = TRUE)
quantile(movies3$PR, probs = c(0.75), na.rm = TRUE)
quantile(movies3$PR, probs = c(1), na.rm = TRUE)
#WRITE YOUR CODE HERE
frequency <- table(movies3$director_gender)
##P(M)##
frequency["male"]/ sum(frequency)
##P(M')##
frequency["female"]/sum(frequency)
pnorm(120, 107, 22)- pnorm(90, 107, 22)
#WRITE YOUR CODE HERE
###Total number of observations###
total_observations <- length(movies3$runtime)
###Number of values within the interval [90, 120]###
R <- (movies3$runtime)
values_within_interval <- sum(R >= 90 & R <= 120)
###number of values within the interval [90, 120]/ total number of observations###
(values_within_interval/total_observations)
#WRITE YOUR CODE HERE
###Filter female directors###
frequency <- table(movies3$director_gender)
total_films_female_director <- frequency["female"]
###Number of films with R â‰¥120###
sum(movies3$runtime >= 120 )
###Number of films by female directors with runtime >= 120###
female_director_runtime_high <- sum(movies3$runtime >= 120 & movies3$director_gender == "female", na.rm = TRUE)
###Number of films by female directors with runtime >= 120 diveded by total number of films by female directors##
(female_director_runtime_high/total_films_female_director)
#WRITE YOUR CODE HERE
library("dplyr")
movies3 = mutate(movies3, PR = revenue/budget)
movies3$PR[is.infinite(movies3$PR)] <- NA
mean(movies3$PR, na.rm = TRUE)
#WRITE YOUR CODE HERE
movies3$PR[is.infinite(movies3$PR)] <- NA
sample_movies <- slice_sample(movies3, n = 25)
mean(sample_movies$PR, na.rm = TRUE)
#WRITE YOUR CODE HERE
movies3$PR[is.infinite(movies3$PR)] <- NA
sample_means <- numeric(100)
for (i in 1:100) {
sample_movies <- slice_sample(movies3, n = 25)
sample_means[i] <- mean(sample_movies$PR, na.rm = TRUE)
}
print(sample_means)
#WRITE YOUR CODE HERE
###Summary of sample means###
summary(sample_means)
###Mean and Standard deviation of sample means###
mean(sample_means)
sd(sample_means)
###Histogram of Sample Means###
library("ggplot2")
ggplot(data.frame(sample_means), aes(x = sample_means)) +
geom_histogram(binwidth = 0.5 ) +
xlim(0, 10) +
labs(
title = "Histogram of Sample Means",
y = "Frequency",
x = "Sample Mean"
)
#WRITE YOUR CODE HERE
thriller_movies <- subset(movies3, genre == "Thriller")
t.test(thriller_movies$vote_average, conf.level = 0.99)
#WRITE YOUR CODE HERE
mean(thriller_movies$vote_average)
sd(thriller_movies$vote_average)
nrow(thriller_movies)
#WRITE YOUR CODE HERE
# Amount Movies With Female Lead
sum(movies3$first_actor_gender == "female", na.rm = TRUE)
# Amount Movies With Male Lead
sum(movies3$first_actor_gender == "male", na.rm = TRUE)
#WRITE YOUR CODE HERE
prop.test(x = 182, n = 182 + 495, p = 0.5)
#WRITE YOUR CODE HERE
movies3$PR <- (movies3$revenue - movies3$budget) / movies3$budget
movies_clean <- movies3[!is.na(movies3$PR) & movies3$budget > 0 & !is.na(movies3$first_actor_gender), ]
var_male <- var(movies_clean$PR[movies_clean$first_actor_gender == "male"])
var_female <- var(movies_clean$PR[movies_clean$first_actor_gender == "female"])
# Calculate PR
movies3$PR <- (movies3$revenue - movies3$budget) / movies3$budget
# Filter only valid movies
movies_clean <- movies3[!is.na(movies3$PR) &
!is.na(movies3$first_actor_gender) &
movies3$budget > 0 &
is.finite(movies3$PR), ]
# Count number of female-lead movies
n_female <- sum(movies_clean$first_actor_gender == "female")
# Sample variance of PR for female-lead movies
s2_female <- var(movies_clean$PR[movies_clean$first_actor_gender == "female"])
# Population variance of PR for male-lead movies
sigma2_male <- var(movies_clean$PR[movies_clean$first_actor_gender == "male"])
# Chi-squared test statistic
chi2_stat <- (n_female - 1) * s2_female / sigma2_male
# Two-sided p-value
p_value <- 2 * min(pchisq(chi2_stat, df = n_female - 1),
1 - pchisq(chi2_stat, df = n_female - 1))
# Print test statistic and p-value
chi2_stat
p_value
#WRITE YOUR CODE HERE
table(movies3$genre)
###Counting movies per genre###
genre_counts <- count(movies3, genre, sort = TRUE)
###Sorting top 3 genres###
top_genres <- genre_counts$genre[1:3]
###Categorizing genres###
movies3$genre2 <- if_else(movies3$genre %in% top_genres, movies3$genre, "Other")
###Frequency table###
count(movies3, genre2)
#WRITE YOUR CODE HERE
###Mean pr genre###
mean_PR <- aggregate(PR ~ genre2, data = movies3, FUN = mean, na.rm = TRUE)
###Creating a scatterplot###
library("ggplot2")
ggplot(mean_PR, aes(x = genre2, y = PR)) +
geom_point(size = 3) +
labs(
title = "Average PR per Genre",
y = "Mean PR",
x = "Genre"
)
#WRITE YOUR CODE HERE
mean_PR <- aggregate(PR ~ genre2, data = movies3, FUN = mean, na.rm = TRUE)
n <- aggregate(PR ~ genre2, data = movies3, FUN = function(x) sum(!is.na(x)))$PR
sd_PR <- aggregate(PR ~ genre2, data = movies3, FUN = sd, na.rm = TRUE)$PR
se <- sd_PR / sqrt(n)
mean_PR$ci_lower <- mean_PR$PR - qt(0.975, df = n-1) * se
mean_PR$ci_upper <- mean_PR$PR + qt(0.975, df = n-1) * se
###Creating a scatterplot###
library("ggplot2")
ggplot(mean_PR, aes(x = genre2, y = PR)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2)
labs(
title = "Average PR per Genre",
y = "Genre",
x = "Mean PR"
)
#WRITE YOUR CODE HERE
###Creating a new datframe which is a random subsample###
sample_genre <- slice_sample(movies3, n = 100)
###Calculating the mean, standard deviation, and number of observations of PR in the sample for each genre###
agg_sample <- aggregate(PR ~ genre2, data = sample_genre, FUN = function(x) c(mean = mean(x), sd = sd(x), n = length(x)))
agg_sample2 <- data.frame(
genre2 = agg_sample$genre2,
PR_mean = agg_sample$PR[, "mean"],
SD = agg_sample$PR[, "sd"],
n = agg_sample$PR[, "n"]
)
###Calculating the confidence intervals (CI's)###
agg_sample2$ci_lower <- agg_sample2$PR_mean - 1.96 * agg_sample2$SD / sqrt(agg_sample2$n)
agg_sample2$ci_upper <- agg_sample2$PR_mean + 1.96 * agg_sample2$SD / sqrt(agg_sample2$n)
###Creating a scatterplot###
library("ggplot2")
ggplot(agg_sample2, aes(x = genre2, y = PR_mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
labs(
title = "Average PR per Genre",
y = "Mean PR",
x = "Genre"
)
#WRITE YOUR CODE HERE
movies3$PR <- ifelse(movies3$budget > 0, movies3$revenue / movies3$budget, NA)
movies3_clean <- movies3[is.finite(movies3$PR) & is.finite(movies3$budget), ]
lm1 <- lm(PR ~ budget, data = movies3_clean)
summary(lm1)
coef(summary(lm1))
summary(lm1)
fitted_values <- fitted(lm1)
residual_values <- residuals(lm1)
head(fitted_values)
head(residual_values)
hist(residuals(lm1),
breaks = 30,
main = "Histogram of Residuals",
xlab = "Residuals",
col = "skyblue",
border = "white")
hat_values <- hatvalues(lm1)
critical_value <- 2 * mean(hat_values)
high_leverage_points <- which(hat_values > critical_value)
high_leverage_points
plot(hat_values, main = "Leverage (Hat) Values",
ylab = "Hat Value", xlab = "Observations")
abline(h = critical_value, col = "red", lty = 2)
movies3_no_outliers <- movies3_clean[-high_leverage_points, ]
lm2 <- lm(PR ~ budget, data = movies3_no_outliers)
summary(lm2)
#WRITE YOUR CODE HERE
library("ggplot2")
ggplot(movies3, aes(x = runtime, y = vote_average)) +
geom_point() +
geom_smooth(method = "lm") +
labs(
title = "Scatterplot",
y = "Vote average",
x = "Runtime"
)
#WRITE YOUR CODE HERE
lm1 <- lm(vote_average ~ runtime, data = movies3)
summary(lm1)
movies3$predict <- predict(lm1)
movies3$residual <- residuals(lm1)
overperformer <- movies3[which.max(movies3$residual),]
print(overperformer[c("title", "vote_average", "predict", "residual")])
#WRITE YOUR CODE HERE
library(dplyr)
movies_with_mean <- movies3 %>%
group_by(release_year) %>%
mutate(
mean_PR = mean(PR, na.rm = TRUE),
se = sd(PR, na.rm = TRUE) / sqrt(n()),
ci_lower = mean_PR - 1.96 * se,
ci_upper = mean_PR + 1.96 * se
)
ci_df <- movies_with_mean %>%
distinct(release_year, mean_PR, ci_lower, ci_upper)
ggplot(ci_df, aes(x = release_year, y = mean_PR)) +
geom_point(size = 2, color = "darkblue") +
geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = "black") +
geom_smooth(method = "loess", se = FALSE) +
(ylim(-10,44)) +
labs(
title = "Mean PR by Year with 95% Confidence Intervals",
x = "Year of Release",
y = "Mean PR"
) +
theme_minimal()
#WRITE YOUR CODE HERE
lm5 <- lm(PR ~ log(budget) + genre2 + release_year, data = movies3)
summary(lm5)
#WRITE YOUR CODE HERE
lm5 <- lm(PR ~ log(budget) + genre2 + release_year, data = movies3)
newdata <-data.frame(budget = 400000000, genre2 = "Comedy", release_year = 2026)
predict(lm5, newdata = newdata, interval = "predict")
#WRITE YOUR CODE HERE
library(ggplot2)
###Residuals vs log(budget)###
ggplot(movies3, aes(x = log(budget), y = residual)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
xlim(-0.5, 20)
labs(
title = "Residuals vs log(budget)",
x = "log(budget)",
y = "Residuals"
) +
theme_minimal()
###Residuals vs Release Year###
ggplot(movies3, aes(x = release_year, y = residual)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
labs(
title = "Residuals vs Release Year",
x = "Release Year",
y = "Residuals"
) +
theme_minimal()
###Residuals vs Genre2###
ggplot(movies3, aes(x = genre2, y = residual)) +
geom_boxplot() +
labs(
title = "Residuals by Genre",
x = "Genre",
y = "Residuals"
) +
theme_minimal()
###Residuals vs Fitted Values###
ggplot(data = data.frame(fitted = fitted(lm5), resid = resid(lm5)), aes(x = fitted, y = resid)) +
geom_point(color = "blue") +
geom_hline(yintercept = 0, color = "red") +
labs(title = "Residuals vs Fitted Values",
x = "Fitted Values",
y = "Residuals") +
theme_minimal()
#WRITE YOUR CODE HERE
movies3 <- movies3 %>%
filter(budget > 0) %>%
mutate(
PR = (revenue - budget) / budget,
english_dummy = ifelse(original_language == "en", 1, 0)
)
movies_lang <- na.omit(movies3)
lm_lang <- lm(PR ~ english_dummy, data = movies_lang)
summary(lm_lang)
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse")
install.packages("stargazer")
install.packages("sjPlot")
library(stargazer)
library(tidyverse)
library(sjPlot)
data <- read_csv(file = "monocentric_2016.csv")
# Making a subset of the data of the municipality of Utrecht
df_utrecht = data %>%
filter(grepl("Utrecht", munname))
df_utrecht_clean <- na.omit(df_utrecht[, c("lnpricem2", "distcbd", "hhsize", "popdens", "shforeign", "shlandres", "shyoungp", "shelderly", "RSdistcbd")])
# Creating a table with the descriptive statistics of the municipality of Utrecht
library(dplyr)
library(knitr)
# Calculate descriptive statistics of the municipality of Utrecht
stats <- df_utrecht_clean %>%
select(lnpricem2, distcbd, hhsize, popdens, shforeign, shlandres, shyoungp, shelderly, RSdistcbd)%>%
summarise(across(everything(), list(
Mean = ~mean(.x, na.rm = TRUE),
SD = ~sd(.x, na.rm = TRUE),
Min = ~min(.x, na.rm = TRUE),
Max = ~max(.x, na.rm = TRUE),
N = ~sum(!is.na(.x))
)) %>%
pivot_longer(everything(), names_to = c("Variable", ".value"), names_sep = "_"))
# Format the table of teh descriptive statistics of the municipality of Utrecht
kable(stats, format = "markdown", caption = "Descriptive Statistics for Utrecht", digits = 2)
# Now I will do the same for The Netherlands
# Calculate descriptive statistics for national level
national_stats <- data %>%
select(lnpricem2, distcbd, hhsize, popdens, shforeign, shlandres, shyoungp, shelderly, RSdistcbd) %>%
summarise(across(everything(), list(
Mean = ~mean(.x, na.rm = TRUE),
SD = ~sd(.x, na.rm = TRUE),
Min = ~min(.x, na.rm = TRUE),
Max = ~max(.x, na.rm = TRUE),
N = ~sum(!is.na(.x))
)) %>%
pivot_longer(everything(), names_to = c("Variable", ".value"), names_sep = "_"))
# Format the table for the national level
kable(national_stats, format = "markdown", caption = "Descriptive Statistics for The Netherlands", digits = 2)
install.packages("sjPlot")
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse")
install.packages("stargazer")
install.packages("sjPlot")
library(stargazer)
library(tidyverse)
library(sjPlot)
data <- read_csv(file = "monocentric_2016.csv")
install.packages("sjPlot")
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse")
install.packages("stargazer")
install.packages("sjPlot")
library(stargazer)
library(tidyverse)
library(sjPlot)
data <- read_csv(file = "monocentric_2016.csv")
install.packages("stargazer")
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse")
install.packages("stargazer")
install.packages("sjPlot")
library(stargazer)
library(tidyverse)
library(sjPlot)
data <- read_csv(file = "monocentric_2016.csv")
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse")
install.packages("stargazer")
install.packages("sjPlot")
library(stargazer)
library(tidyverse)
library(sjPlot)
data <- read_csv(file = "monocentric_2016.csv")
setwd("~/Documents/GitHub/Regional-and-Urban-Economics/Regional and Urban Economics")
